{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Tehtävät</h2>
    <form method="POST" action="{{ url_for('main.tasks') }}">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.member_name.label(class="form-label") }}  <!-- Add Member Name field -->
            {{ form.member_name(class="form-control") }}

        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.title.label(class="form-label") }}
            {{ form.title(class="form-control") }}
        </div>
        <div class="form-group">
            {{ form.description.label(class="form-label") }}
            {{ form.description(class="form-control") }}
        </div>
        <div class="form-group">
            {{ form.due_date.label(class="form-label") }}
            {{ form.due_date(class="form-control") }}
        </div>
        <div class="form-group">
            {{ form.status.label(class="form-label") }}
            {{ form.status(class="form-control") }}
        </div>
        <div class="form-group">
            {{ form.submit(class="btn btn-primary") }}
        </div>
    </form>
    <hr>
    <h3>Tehtävälista</h3>
    <ul class="list-group">
        {% for task in tasks %}
        <li class="list-group-item">
            <h5>{{ task.title }}</h5>
            <p>Jäsenen nimi: {{ task.member_name }}</p>
            <p>{{ task.description }}</p>
            <p>Eräpäivä: {{ task.due_date }}</p>
            <p>Tila: {{ task.status }}</p>
            <form method="POST" action="{{ url_for('main.update_task_status', id=task.id) }}">
                <input type="hidden" name="status" value="{{ 'completed' if task.status == 'pending' else 'pending' }}">
                <button type="submit" class="btn btn-secondary">{{ 'Mark as Completed' if task.status == 'pending' else 'Mark as Pending' }}</button>
            </form>
            <a href="{{ url_for('main.edit_task', id=task.id) }}" class="btn btn-warning">Edit</a>
            <form method="POST" action="{{ url_for('main.delete_task', id=task.id) }}" style="display:inline;">
                <button type="submit" class="btn btn-danger">Delete</button>
            </form>
        </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}